<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- JAVA와 연결할 Mapper 파일 설정 -->
<mapper namespace="poly.persistance.mapper.CONSUMER_Gps_TableMapper">

	<!-- GPS정보 DB저장 -->
	<insert id="setGps" parameterType="CONSUMER_Gps_TableDTO">
		INSERT INTO GPS_TABLE
			(
				GPS_SEQ,
				USER_SEQ,
				GPS_RENEW_DATE,
				GPS_SIDO,
				GPS_SIGUNGU,
				GPS_DONG,
				GPS_X,
				GPS_Y
			)
			VALUES
			(
				GPS_SEQ.NEXTVAL,
				#{user_seq},
				#{gps_renew_date},
				#{gps_sido},
				#{gps_sigungu},
				#{gps_dong},
				#{gps_x},
				#{gps_y}
			)
	</insert>
	<update id="updateGps" parameterType="integer">
		UPDATE FT_INFO
			SET
				GPS_SEQ = 
				(	
					SELECT GPS_SEQ
					
					FROM 
						( SELECT GPS_SEQ, USER_SEQ FROM GPS_TABLE WHERE USER_SEQ = #{user_seq} ORDER BY GPS_RENEW_DATE DESC)
					WHERE
						<![CDATA[ROWNUM = 1]]>	
	    	    )
			WHERE
				USER_SEQ = #{user_seq}
	</update>
	
</mapper>